# Examples

Example resources in this IG are manually constructed in JSON (rather than using [FSH](https://fshschool.org/)) so as to precisely control the content of the example to meet the data minimization rules in the IG.

Rather than writing _both_ Bundle examples and separate examples of the included resources (e.g., Patient), we only write the Bundle examples and then use `script/update-examples` to extract the included resources from the Bundle examples to use as examples for other profiles. For example, the Patient resource from `bundle-immunization-covid.json` is extracted and used as the example for the `shc-patient-general-dm` Profile.

These auto-generated examples are also stored in this folder, but their filenames are prefixed with `zzz-autogenerated`.

The `_examples.yaml` file controls which examples are generated from which Bundle examples.

## Duplicate examples

Due to a limitation in FHIR R4, each example resource can only be associated with one Profile without including `meta.profile` in the example (which is prohibited by our primary data minimization profiles). Therefore, `script/update-examples` also produces a duplicate example so the same source of truth can be used for both primary and fallback profiles. Duplicate examples are suffixed with `b`, `c`, `d`, etc.

## Updating `sushi-config.yaml`

Additionally, each example requires three additions to `sushi-config.yaml`:

1. `resources.$ResourceType/$example-resource-id.exampleCanonical` must be set to the canonical URI of the profile that the example is associated with. This is how the IG Publisher knows to add a given example to the correct `...examples.html` page.
2. An entry needs to be added to the `parameters.no-narrative` array. This suppresses the `text` element that is usually auto-generated by the IG Publisher for each example.
3. An entry needs to be added to the comma-delimited `parameters.suppressed-ids` string, which suppresses the `id` element that usually appears in examples. (Note that our raw JSON examples do need to have `id` set to avoid an IG Publisher error, but both the raw JSON and HTML views generated by the IG Publisher will suppress `id` based on this parameter.)
